{"ast":null,"code":"import _slicedToArray from\"C:/Users/Sator/WebProjects/kanjiMnemonics/create-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useRef,useContext,useEffect}from'react';import{FontAwesomeIcon}from'@fortawesome/react-fontawesome';import{faEdit,faFloppyDisk}from'@fortawesome/free-solid-svg-icons';import renderHTML from'react-render-html';import{updateKanji}from'../hooks/updateKanji';import{UserContext}from'../App';import{Tooltip}from'react-tooltip';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Mnemonic=function Mnemonic(_ref){var selectedKanji=_ref.selectedKanji;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),editing=_useState2[0],setEditing=_useState2[1];var _useState3=useState(faEdit),_useState4=_slicedToArray(_useState3,2),icon=_useState4[0],setIcon=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),iconClass=_useState6[0],setIconClass=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),mnemonic=_useState8[0],setmnemonic=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),tooltipContent=_useState10[0],setTooltipContent=_useState10[1];var _useContext=useContext(UserContext),user=_useContext.user;var textDiv=useRef(null);// get the mnemonic to display\nuseEffect(function(){var mnemonicFound=false;// if logged in, get user's mnemonic\nif(user){mnemonicFound=selectedKanji.mnemonic.find(function(x){return x.username===user.username;});// set tooltip content\nsetTooltipContent(\"Edit\");}else{// set tooltip content\nsetTooltipContent(\"Login to edit\");}// if mnemonic not found, get default mnemonic\nif(!mnemonicFound||mnemonicFound===-1||mnemonicFound===undefined){mnemonicFound=selectedKanji.mnemonic.find(function(x){return x.username===\"\"||!x.hasOwnProperty('username');});}setmnemonic(mnemonicFound);},[selectedKanji,user,setmnemonic]);// toggle between editing mode\nvar toggleEditing=function toggleEditing(){// return if not logged in\nif(!user){return;}// switch to edit mode\nif(!editing){// animation class\nsetIconClass(\"fa-beat-fade\");// change to save icon\nsetIcon(faFloppyDisk);// focus on textarea\ntextDiv.current.focus();// set tooltip content\nsetTooltipContent(\"Save\");}// save updated mnemonic and switch to normal mode\nelse{// remove animation class\nsetIconClass(\"\");// switch to edit icon\nsetIcon(faEdit);// remove focus \ntextDiv.current.blur();// update the mnemonic and kanji data\nvar updatedText=textDiv.current.innerHTML.substring(0,textDiv.current.innerHTML.indexOf(\"<svg\"));var foundIndex=selectedKanji.mnemonic.findIndex(function(x){return x.username===user.username;});var _mnemonic={text:updatedText,username:user.username};if(foundIndex!==-1){selectedKanji.mnemonic[foundIndex]=_mnemonic;}else{selectedKanji.mnemonic.push(_mnemonic);}// send post request to database\nupdateKanji({selectedKanji:selectedKanji});// set tooltip content\nsetTooltipContent(\"Edit\");}setEditing(!editing);};return/*#__PURE__*/_jsxs(\"div\",{className:\"mnemonic\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"How to remember:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"textDiv\",contentEditable:editing,suppressContentEditableWarning:true,ref:textDiv,tabIndex:0,children:[mnemonic&&renderHTML(mnemonic.text),/*#__PURE__*/_jsx(Tooltip,{id:\"edit-tooltip\"}),/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:icon,className:iconClass,onClick:function onClick(){return toggleEditing();},\"data-tooltip-id\":\"edit-tooltip\",\"data-tooltip-content\":tooltipContent})]})]});};export default Mnemonic;","map":{"version":3,"names":["useState","useRef","useContext","useEffect","FontAwesomeIcon","faEdit","faFloppyDisk","renderHTML","updateKanji","UserContext","Tooltip","jsx","_jsx","jsxs","_jsxs","Mnemonic","_ref","selectedKanji","_useState","_useState2","_slicedToArray","editing","setEditing","_useState3","_useState4","icon","setIcon","_useState5","_useState6","iconClass","setIconClass","_useState7","_useState8","mnemonic","setmnemonic","_useState9","_useState10","tooltipContent","setTooltipContent","_useContext","user","textDiv","mnemonicFound","find","x","username","undefined","hasOwnProperty","toggleEditing","current","focus","blur","updatedText","innerHTML","substring","indexOf","foundIndex","findIndex","text","push","className","children","contentEditable","suppressContentEditableWarning","ref","tabIndex","id","onClick"],"sources":["C:/Users/Sator/WebProjects/kanjiMnemonics/create-react-app/src/components/Mnemonic.js"],"sourcesContent":["import { useState, useRef, useContext, useEffect } from 'react'\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\r\nimport { faEdit, faFloppyDisk } from '@fortawesome/free-solid-svg-icons';\r\nimport renderHTML from 'react-render-html'\r\nimport { updateKanji } from '../hooks/updateKanji';\r\nimport { UserContext } from '../App';\r\nimport { Tooltip } from 'react-tooltip'\r\n\r\n\r\nconst Mnemonic = ({ selectedKanji }) => {\r\n    const [editing, setEditing] = useState(false)\r\n    const [icon, setIcon] = useState(faEdit)\r\n    const [iconClass, setIconClass] = useState(\"\")\r\n    const [mnemonic, setmnemonic] = useState(\"\")\r\n    const [tooltipContent, setTooltipContent] = useState(\"\")\r\n    const { user } = useContext(UserContext)\r\n    const textDiv = useRef(null)\r\n\r\n    // get the mnemonic to display\r\n    useEffect(() => {\r\n        let mnemonicFound = false;\r\n        // if logged in, get user's mnemonic\r\n        if (user) {\r\n            mnemonicFound = selectedKanji.mnemonic.find(x => x.username === user.username)\r\n\r\n            // set tooltip content\r\n            setTooltipContent(\"Edit\")\r\n        }\r\n        else {\r\n            // set tooltip content\r\n            setTooltipContent(\"Login to edit\")\r\n        }\r\n\r\n        // if mnemonic not found, get default mnemonic\r\n        if (!mnemonicFound || mnemonicFound === -1 || mnemonicFound === undefined) {\r\n            mnemonicFound = selectedKanji.mnemonic.find(x => x.username === \"\" || !x.hasOwnProperty('username'))\r\n        }\r\n\r\n        setmnemonic(mnemonicFound)\r\n    }, [selectedKanji, user, setmnemonic])\r\n\r\n    // toggle between editing mode\r\n    const toggleEditing = () => {\r\n        // return if not logged in\r\n        if (!user) {\r\n            return\r\n        }\r\n\r\n        // switch to edit mode\r\n        if (!editing) {\r\n            // animation class\r\n            setIconClass(\"fa-beat-fade\")\r\n            // change to save icon\r\n            setIcon(faFloppyDisk)\r\n            // focus on textarea\r\n            textDiv.current.focus()\r\n            // set tooltip content\r\n            setTooltipContent(\"Save\")\r\n        }\r\n        // save updated mnemonic and switch to normal mode\r\n        else {\r\n            // remove animation class\r\n            setIconClass(\"\")\r\n            // switch to edit icon\r\n            setIcon(faEdit)\r\n            // remove focus \r\n            textDiv.current.blur()\r\n            // update the mnemonic and kanji data\r\n            const updatedText = textDiv.current.innerHTML.substring(0, textDiv.current.innerHTML.indexOf(\"<svg\"))\r\n            const foundIndex = selectedKanji.mnemonic.findIndex(x => x.username === user.username)\r\n            const mnemonic = {\r\n                text: updatedText,\r\n                username: user.username\r\n            }\r\n\r\n            if (foundIndex !== -1) {\r\n                selectedKanji.mnemonic[foundIndex] = mnemonic\r\n            }\r\n            else {\r\n                selectedKanji.mnemonic.push(mnemonic)\r\n            }\r\n            // send post request to database\r\n            updateKanji({ selectedKanji })\r\n\r\n            // set tooltip content\r\n            setTooltipContent(\"Edit\")\r\n        }\r\n\r\n        setEditing(!editing)\r\n    }\r\n\r\n    return (\r\n        <div className=\"mnemonic\">\r\n            <p>How to remember:</p>\r\n            <div className=\"textDiv\" contentEditable={editing} suppressContentEditableWarning={true} ref={textDiv} tabIndex={0}>\r\n                {mnemonic && renderHTML(mnemonic.text)}\r\n                <Tooltip id=\"edit-tooltip\" />\r\n                <FontAwesomeIcon icon={icon} className={iconClass} onClick={() => toggleEditing()} data-tooltip-id=\"edit-tooltip\" data-tooltip-content={tooltipContent} />\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Mnemonic"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}