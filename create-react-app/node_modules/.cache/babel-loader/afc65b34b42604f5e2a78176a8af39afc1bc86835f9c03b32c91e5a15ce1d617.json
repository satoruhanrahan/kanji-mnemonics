{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Sator/WebProjects/kanjiMnemonics/create-react-app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Sator/WebProjects/kanjiMnemonics/create-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Sator/WebProjects/kanjiMnemonics/create-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useContext}from'react';import{UserContext}from\"../App\";export var useLogin=function useLogin(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),error=_useState2[0],setError=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];var _useContext=useContext(UserContext),user=_useContext.user,setUser=_useContext.setUser;var login=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(username,password){var api,response,json;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:setIsLoading(true);setError(null);api=\"/api/user/login\";if(process.env.REACT_APP_NODE_ENV==='development'){api='http://localhost:'+process.env.REACT_APP_BACKEND_PORT+api;}_context.next=6;return fetch(api,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username:username,password:password})});case 6:response=_context.sent;_context.next=9;return response.json();case 9:json=_context.sent;if(!response.ok){setIsLoading(false);setError(json.error);}if(response.ok){// save user to local storage\nlocalStorage.setItem('user',JSON.stringify(json));// update auth context\nsetUser(json);setIsLoading(false);}return _context.abrupt(\"return\",response);case 13:case\"end\":return _context.stop();}},_callee);}));return function login(_x,_x2){return _ref.apply(this,arguments);};}();return{login:login,isLoading:isLoading,error:error,user:user};};","map":{"version":3,"names":["useState","useContext","UserContext","useLogin","_useState","_useState2","_slicedToArray","error","setError","_useState3","_useState4","isLoading","setIsLoading","_useContext","user","setUser","login","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","username","password","api","response","json","wrap","_callee$","_context","prev","next","process","env","REACT_APP_NODE_ENV","REACT_APP_BACKEND_PORT","fetch","method","headers","body","JSON","stringify","sent","ok","localStorage","setItem","abrupt","stop","_x","_x2","apply","arguments"],"sources":["C:/Users/Sator/WebProjects/kanjiMnemonics/create-react-app/src/hooks/useLogin.js"],"sourcesContent":["import { useState, useContext } from 'react'\r\nimport { UserContext } from \"../App\"\r\n\r\nexport const useLogin = () => {\r\n    const [error, setError] = useState(null)\r\n    const [isLoading, setIsLoading] = useState(null)\r\n    const { user, setUser } = useContext(UserContext)\r\n\r\n    const login = async (username, password) => {\r\n        setIsLoading(true)\r\n        setError(null)\r\n\r\n        let api = \"/api/user/login\";\r\n        if (process.env.REACT_APP_NODE_ENV === 'development') {\r\n            api = 'http://localhost:' + process.env.REACT_APP_BACKEND_PORT + api\r\n        }\r\n\r\n        const response = await fetch(api, {\r\n            method: 'POST',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify({ username, password })\r\n        })\r\n\r\n        const json = await response.json()\r\n\r\n        if (!response.ok) {\r\n            setIsLoading(false)\r\n            setError(json.error)\r\n        }\r\n        if (response.ok) {\r\n            // save user to local storage\r\n            localStorage.setItem('user', JSON.stringify(json))\r\n\r\n            // update auth context\r\n            setUser(json)\r\n\r\n            setIsLoading(false)\r\n        }\r\n\r\n        return response\r\n    }\r\n\r\n    return { login, isLoading, error, user }\r\n}"],"mappings":"gcAAA,OAASA,QAAQ,CAAEC,UAAU,KAAQ,OAAO,CAC5C,OAASC,WAAW,KAAQ,QAAQ,CAEpC,MAAO,IAAM,CAAAC,QAAQ,CAAG,QAAX,CAAAA,QAAQA,CAAA,CAAS,CAC1B,IAAAC,SAAA,CAA0BJ,QAAQ,CAAC,IAAI,CAAC,CAAAK,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAAjCG,KAAK,CAAAF,UAAA,IAAEG,QAAQ,CAAAH,UAAA,IACtB,IAAAI,UAAA,CAAkCT,QAAQ,CAAC,IAAI,CAAC,CAAAU,UAAA,CAAAJ,cAAA,CAAAG,UAAA,IAAzCE,SAAS,CAAAD,UAAA,IAAEE,YAAY,CAAAF,UAAA,IAC9B,IAAAG,WAAA,CAA0BZ,UAAU,CAACC,WAAW,CAAC,CAAzCY,IAAI,CAAAD,WAAA,CAAJC,IAAI,CAAEC,OAAO,CAAAF,WAAA,CAAPE,OAAO,CAErB,GAAM,CAAAC,KAAK,6BAAAC,IAAA,CAAAC,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAG,SAAAC,QAAOC,QAAQ,CAAEC,QAAQ,MAAAC,GAAA,CAAAC,QAAA,CAAAC,IAAA,QAAAP,mBAAA,GAAAQ,IAAA,UAAAC,SAAAC,QAAA,iBAAAA,QAAA,CAAAC,IAAA,CAAAD,QAAA,CAAAE,IAAA,SACnCnB,YAAY,CAAC,IAAI,CAAC,CAClBJ,QAAQ,CAAC,IAAI,CAAC,CAEVgB,GAAG,CAAG,iBAAiB,CAC3B,GAAIQ,OAAO,CAACC,GAAG,CAACC,kBAAkB,GAAK,aAAa,CAAE,CAClDV,GAAG,CAAG,mBAAmB,CAAGQ,OAAO,CAACC,GAAG,CAACE,sBAAsB,CAAGX,GAAG,CACxE,CAACK,QAAA,CAAAE,IAAA,SAEsB,CAAAK,KAAK,CAACZ,GAAG,CAAE,CAC9Ba,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CAAE,cAAc,CAAE,kBAAmB,CAAC,CAC/CC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CAAEnB,QAAQ,CAARA,QAAQ,CAAEC,QAAQ,CAARA,QAAS,CAAC,CAC/C,CAAC,CAAC,QAJIE,QAAQ,CAAAI,QAAA,CAAAa,IAAA,CAAAb,QAAA,CAAAE,IAAA,SAMK,CAAAN,QAAQ,CAACC,IAAI,CAAC,CAAC,QAA5BA,IAAI,CAAAG,QAAA,CAAAa,IAAA,CAEV,GAAI,CAACjB,QAAQ,CAACkB,EAAE,CAAE,CACd/B,YAAY,CAAC,KAAK,CAAC,CACnBJ,QAAQ,CAACkB,IAAI,CAACnB,KAAK,CAAC,CACxB,CACA,GAAIkB,QAAQ,CAACkB,EAAE,CAAE,CACb;AACAC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAEL,IAAI,CAACC,SAAS,CAACf,IAAI,CAAC,CAAC,CAElD;AACAX,OAAO,CAACW,IAAI,CAAC,CAEbd,YAAY,CAAC,KAAK,CAAC,CACvB,CAAC,OAAAiB,QAAA,CAAAiB,MAAA,UAEMrB,QAAQ,2BAAAI,QAAA,CAAAkB,IAAA,MAAA1B,OAAA,GAClB,kBAhCK,CAAAL,KAAKA,CAAAgC,EAAA,CAAAC,GAAA,SAAAhC,IAAA,CAAAiC,KAAA,MAAAC,SAAA,OAgCV,CAED,MAAO,CAAEnC,KAAK,CAALA,KAAK,CAAEL,SAAS,CAATA,SAAS,CAAEJ,KAAK,CAALA,KAAK,CAAEO,IAAI,CAAJA,IAAK,CAAC,CAC5C,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}